@page "/"
@page "/index.html"

@using Blazor.Fluxor
@using Store.Climb
@inject IState<ClimbState> ClimbState
@inject IDispatcher Dispatcher

<style>
    .app-fab--fixed {
        position: fixed;
        bottom: 1rem;
        right: 1rem;
    }
</style>

<MatAppBarContainer>
    <MatAppBar Fixed="true">
        <MatAppBarRow>
            <MatAppBarSection>
                <MatIconButton OnClick="@ToggleDrawer" Icon="menu"></MatIconButton>
                <MatAppBarTitle>Gumby</MatAppBarTitle>
            </MatAppBarSection>
            <MatAppBarSection Align="@MatAppBarSectionAlign.End">
                <MatIconButton Icon="@MatIconNames.Person"></MatIconButton>
            </MatAppBarSection>
        </MatAppBarRow>
    </MatAppBar>
    <MatAppBarContent>
        <MatDrawerContainer Style="width: 100vw; height: 100vw;">
            <MatDrawer Opened="@_isOpenDrawer">
                <MatList SingleSelection="true" TwoLine="true">
                    <MatListItem>
                        <MatListItemText>
                            <MatListItemPrimaryText>
                                <NavLink href="/">Home</NavLink>
                            </MatListItemPrimaryText>
                        </MatListItemText>
                    </MatListItem>
                </MatList>
            </MatDrawer>
        </MatDrawerContainer>
    </MatAppBarContent>

    Number of climbs added: @ClimbState.Value.NumClimbs
</MatAppBarContainer>

<MatFAB class="app-fab--fixed" OnClick="@OpenAddClimbModal" Icon="@MatIconNames.Add"></MatFAB>

<MatDialog IsOpen="@_isOpenAddClimbModal">
    <MatDialogTitle>Add Climb</MatDialogTitle>
    <MatDialogContent>
        <MatIcon Icon="camera"></MatIcon>
    </MatDialogContent>
    <MatDialogActions>
        <MatButton OnClick="@CancelAddClimbClicked">Cancel</MatButton>
        <MatButton OnClick="@OkAddClimbClicked">OK</MatButton>
    </MatDialogActions>
</MatDialog>

@functions{
    private bool _isOpenAddClimbModal = false;
    private bool _isOpenDrawer = false;

    void OpenAddClimbModal()
    {
        _isOpenAddClimbModal = true;
    }

    void OkAddClimbClicked()
    {
        Dispatcher.Dispatch(new AddClimbAction());
        _isOpenAddClimbModal = false;
    }

    void CancelAddClimbClicked()
    {
        _isOpenAddClimbModal = false;
    }

    void ToggleDrawer()
    {
        _isOpenDrawer = !_isOpenDrawer;
    }

}